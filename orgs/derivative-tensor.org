#+title: 矩阵求导的一般规律
#+date: Sun Oct 13 20:03:54 2024
#+author: Zi Liang
#+email: zi1415926.liang@connect.polyu.hk
#+latex_class: elegantpaper
#+filetags: :research:mathbasic:


Consider two vector $x\in \mathbb{R}^{d_{I}}$ and $y\in \mathbb{R}^{d_{O}}$, and $y=Wx$ with $W\in \mathbb{R}^{d_{o}\times d_{I}}$ .

\begin{equation}
\begin{aligned}
&\frac{dy}{dx}\in\mathbb{R}^{d^{O}\times~d^{I}}\\
&\frac{dy}{dx}=W
\end{aligned}
\end{equation}


\begin{equation}
\begin{aligned}
&\frac{dy}{dW}\in\mathbb{R}^{d^{O}\times~d^{O}\times d_{I}}\\
&\frac{dy}{dW}=I_{d_{O}}\otimes x^{T}
\end{aligned}
\end{equation}

If we define $W=MN$, where $M\in \mathbb{R}^{d_{O}\times r}$ and $N\in
\mathbb{R}^{r\times d_{I}}$, we have

\begin{equation}
\begin{aligned}
&\frac{dy}{dM}\in\mathbb{R}^{d^{O}\times~d^{O}\times r}\\
&\frac{dy}{dM}=I_{d_{O}}\otimes (Nx)^{T}=I_{d_{O}}\otimes (x)^{T}N^{T}\\
\end{aligned}
\end{equation}
and
\begin{equation}
\begin{aligned}
&\frac{dy}{dN}\in\mathbb{R}^{d_{O}\times~r\times d_{I}}\\
&\frac{dy}{dN}=\frac{dy}{dNx}\cdot \frac{dNx}{dN}=M\cdot I_{r}\otimes x^{T}\\
\end{aligned}
\end{equation}







    
